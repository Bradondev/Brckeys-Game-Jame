[gd_scene load_steps=12 format=3 uid="uid://b884uknjsec3j"]

[ext_resource type="Script" path="res://Scripts/Ai/Monster.gd" id="1_d7srs"]
[ext_resource type="PackedScene" uid="uid://cxehjjkyq2ld1" path="res://3d/jerry/jerry_fixed.tscn" id="2_44dm1"]
[ext_resource type="Script" path="res://Scripts/Ai/StateMachine.gd" id="2_smmno"]
[ext_resource type="Script" path="res://Scripts/Ai/MonsterIdle.gd" id="3_5vln3"]
[ext_resource type="Script" path="res://Scripts/Ai/MonsterChase.gd" id="4_1g41x"]
[ext_resource type="Script" path="res://Scripts/Ai/MonsterDash.gd" id="5_qtln4"]
[ext_resource type="Script" path="res://Scripts/Ai/MonsterScan.gd" id="6_8q1jc"]
[ext_resource type="Script" path="res://Scripts/Ai/MonsterConfuse.gd" id="6_al6yw"]
[ext_resource type="Script" path="res://Scripts/Ai/MonsterglitchOut.gd" id="9_en0ku"]

[sub_resource type="BoxShape3D" id="BoxShape3D_8f00h"]
size = Vector3(1.54095, 1.54785, 3.00058)

[sub_resource type="BoxShape3D" id="BoxShape3D_ibafn"]
size = Vector3(1, 1, 2.81448)

[node name="Monster" type="CharacterBody3D" groups=["monster"]]
collision_layer = 8
collision_mask = 0
axis_lock_angular_x = true
axis_lock_angular_z = true
script = ExtResource("1_d7srs")
redColor = Color(0.917647, 0, 0, 1)
greenColor = Color(0, 0.964706, 0, 1)

[node name="JerryFixed" parent="." instance=ExtResource("2_44dm1")]
transform = Transform3D(-0.75, 0, 6.55671e-08, 0, 0.75, 0, -6.55671e-08, 0, -0.75, 0, -0.940441, 0)

[node name="Skeleton3D" parent="JerryFixed/JerryFixed/metarig" index="0"]
bones/1/position = Vector3(0.0962725, 1.63921, -0.671637)
bones/2/rotation = Quaternion(0.901864, 0.0454452, 0.00174707, -0.429619)
bones/3/rotation = Quaternion(-0.060493, 0.00140943, -0.026044, 0.997828)
bones/4/rotation = Quaternion(-0.0326729, -0.000193381, 0.00446889, 0.999456)
bones/5/rotation = Quaternion(-0.157114, 3.79416e-05, 0.0158563, 0.987453)
bones/6/rotation = Quaternion(-0.157734, -0.000172493, 0.0317478, 0.986971)
bones/7/rotation = Quaternion(-0.143734, -0.000897678, 0.0580315, 0.987913)
bones/8/rotation = Quaternion(-0.126837, 0.000895455, 0.0913675, 0.987706)
bones/9/rotation = Quaternion(-0.0515194, -0.000577929, 0.124777, 0.990846)
bones/10/rotation = Quaternion(0.00921943, -0.000737008, 0.142426, 0.989762)
bones/11/rotation = Quaternion(0.0562876, 0.00100891, 0.143589, 0.988035)
bones/12/rotation = Quaternion(0.129274, -0.0023178, 0.144083, 0.981083)
bones/13/rotation = Quaternion(0.185527, 0.00217346, 0.153692, 0.970543)
bones/14/rotation = Quaternion(0.290325, -0.000848777, 0.176563, 0.940498)
bones/15/rotation = Quaternion(0.345882, -3.47789e-05, 0.18741, 0.919371)
bones/16/rotation = Quaternion(0.347889, 0.000715758, 0.139791, 0.927055)
bones/17/rotation = Quaternion(0.277721, -3.41787e-05, -0.00747552, 0.960633)
bones/17/scale = Vector3(0.999989, 1, 0.999989)
bones/18/rotation = Quaternion(0.111149, 0.00122789, -0.245448, 0.963016)
bones/18/scale = Vector3(0.999998, 1, 0.999998)
bones/19/rotation = Quaternion(-0.217917, -0.00395413, -0.379045, 0.899345)
bones/22/rotation = Quaternion(-0.064879, -0.0119767, 0.0590173, 0.996074)
bones/23/rotation = Quaternion(0.373843, -0.0156982, 0.0542205, 0.925773)
bones/24/rotation = Quaternion(0.0666092, 0.00783804, -0.116939, 0.990872)
bones/25/rotation = Quaternion(-0.0122763, 0.00774967, -0.11802, 0.992905)
bones/25/scale = Vector3(0.871178, 0.871179, 0.871178)
bones/26/rotation = Quaternion(-0.0309355, 0.00967939, -0.084774, 0.995873)
bones/27/rotation = Quaternion(-0.104784, 0.00794502, -0.0201705, 0.994259)
bones/28/rotation = Quaternion(-0.0724903, 0.000365783, 0.0621554, 0.99543)
bones/29/rotation = Quaternion(0.162761, 0.940875, 0.296598, 0.0171216)
bones/30/rotation = Quaternion(0.714181, -0.238026, -0.128016, -0.645679)
bones/31/rotation = Quaternion(0.80272, -0.0224873, -0.102285, 0.587088)
bones/33/rotation = Quaternion(-0.216903, 0.92483, 0.292626, 0.109605)
bones/34/rotation = Quaternion(0.575201, 0.0975346, -0.152378, -0.797754)
bones/35/rotation = Quaternion(0.756482, -0.216603, 0.146356, 0.599498)
bones/38/rotation = Quaternion(-0.251902, 0.0151769, 0.944692, -0.209457)
bones/39/rotation = Quaternion(-0.49671, 0.0544082, -0.105467, 0.859765)
bones/40/rotation = Quaternion(0.727311, -0.0214021, 0.00620228, 0.685946)
bones/42/rotation = Quaternion(0.284789, 0.121879, 0.904745, 0.292365)
bones/43/rotation = Quaternion(-0.407386, -0.0155426, 0.0561929, 0.911393)
bones/44/rotation = Quaternion(0.401526, 0.116324, -0.0177055, 0.908258)
bones/45/position = Vector3(0.145804, 1.52898, 2.5829)
bones/45/rotation = Quaternion(0.647143, 0.228838, 0.0429653, 0.725943)
bones/46/rotation = Quaternion(0.962259, 9.73241e-08, 3.44129e-07, -0.272137)
bones/47/position = Vector3(0.571881, 0.28555, 1.80695)
bones/47/rotation = Quaternion(-5.60915e-06, -0.00446565, 0.99999, 1.6643e-07)
bones/48/rotation = Quaternion(0.490823, -6.61367e-06, 3.01134e-09, 0.871259)
bones/51/rotation = Quaternion(0.0348339, 0.00584704, -0.0126979, 0.999295)
bones/52/rotation = Quaternion(-0.0360596, 0.920578, 0.388842, 0.00613613)
bones/54/rotation = Quaternion(-0.0228618, 0.00477434, -0.000735081, 0.999727)
bones/57/rotation = Quaternion(-0.0197151, 0.0352909, -0.00484276, 0.999171)
bones/58/position = Vector3(-0.18523, 0.288334, 1.99587)
bones/58/rotation = Quaternion(0.0956158, -0.00444521, 0.995407, 0.00183646)
bones/62/rotation = Quaternion(0.0348339, -0.00584704, 0.0126979, 0.999295)
bones/63/rotation = Quaternion(0.0360596, 0.920578, 0.388842, -0.00613613)
bones/65/rotation = Quaternion(-0.0228618, -0.00477434, 0.000735081, 0.999727)
bones/68/rotation = Quaternion(-0.0197151, -0.0352909, 0.00484276, 0.999171)
bones/69/position = Vector3(0.434609, 0.353809, -1.64886)
bones/79/position = Vector3(-0.977884, 0.346643, -2.13507)
bones/80/rotation = Quaternion(0.745069, -0.130738, 0.130489, 0.6409)
bones/83/rotation = Quaternion(0.628142, 0.0294104, -0.0995841, 0.771139)
bones/86/rotation = Quaternion(0.672341, 0.117545, -0.201903, 0.702408)

[node name="HeadAttachment" parent="JerryFixed/JerryFixed/metarig/Skeleton3D" index="24"]
transform = Transform3D(0.891573, 0.233805, 0.387856, 0.3626, 0.144567, -0.920664, -0.271327, 0.961476, 0.0441141, 0.145814, 1.51003, 1.29837)

[node name="DashRayCast" type="RayCast3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment" index="0"]
transform = Transform3D(-0.345534, -9.45829e-07, -0.938407, 0.937764, -0.0370494, -0.345297, -0.0347671, -0.999314, 0.0128028, 0.498638, -1.31588, 1.10717)
enabled = false
target_position = Vector3(40, 0, 0)
collision_mask = 4
debug_shape_custom_color = Color(0.72549, 0.521569, 1, 1)

[node name="RaycastHolder" type="Node3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment" index="1"]
transform = Transform3D(2.13163e-14, 4.37116e-08, 1, 1, -4.47035e-08, 0, 3.72529e-08, 1, -4.37114e-08, -0.00255176, 0.390168, -0.500868)

[node name="Scanner" type="RayCast3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/RaycastHolder"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.21152, 0.471398, -9.24583e-09)
target_position = Vector3(15, 0, 0)
hit_from_inside = true
collide_with_areas = true

[node name="Scanner2" type="RayCast3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/RaycastHolder"]
transform = Transform3D(0.984808, 0, 0.173648, 0, 1, 0, -0.173648, 0, 0.984808, 0, 0.471398, 0)
target_position = Vector3(12, 0, 0)
hit_from_inside = true
collide_with_areas = true

[node name="Scanner3" type="RayCast3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/RaycastHolder"]
transform = Transform3D(0.984808, 0, -0.173648, 0, 1, 0, 0.173648, 0, 0.984808, 0, 0.471398, 0)
target_position = Vector3(12, 0, 0)
hit_from_inside = true
collide_with_areas = true

[node name="Scanner4" type="RayCast3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/RaycastHolder"]
transform = Transform3D(0.965926, 7.45058e-09, 0.258819, -7.45058e-09, 1, -1.86265e-09, -0.258819, -3.64153e-14, 0.965926, 0.0584368, 0.469231, 6.75209e-09)
target_position = Vector3(12, 0, 0)
hit_from_inside = true
collide_with_areas = true

[node name="Scanner5" type="RayCast3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/RaycastHolder"]
transform = Transform3D(0.965926, 0, -0.258819, 0, 1, 0, 0.258819, 0, 0.965926, 0, 0.471398, 0)
target_position = Vector3(12, 0, 0)
hit_from_inside = true
collide_with_areas = true

[node name="Scanner6" type="RayCast3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/RaycastHolder"]
transform = Transform3D(0.939693, 0, 0.34202, 0, 1, 0, -0.34202, 0, 0.939693, 0, 0.471398, 0)
target_position = Vector3(12, 0, 0)
hit_from_inside = true
collide_with_areas = true

[node name="Scanner7" type="RayCast3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/RaycastHolder"]
transform = Transform3D(0.939693, 0, -0.34202, 0, 1, 0, 0.34202, 0, 0.939693, 0, 0.471398, 0)
target_position = Vector3(12, 0, 0)
hit_from_inside = true
collide_with_areas = true

[node name="BackScanner8" type="RayCast3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/RaycastHolder"]
transform = Transform3D(0.707107, 0, -0.707107, -1.86265e-09, 1, -1.86265e-09, 0.707107, -4.04121e-14, 0.707107, 0, 0.471398, -2.32831e-10)
target_position = Vector3(0, 0, 6)
hit_from_inside = true
collide_with_areas = true

[node name="BackScanner9" type="RayCast3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/RaycastHolder"]
transform = Transform3D(1.053e-07, 0, -1, 0, 1, 0, 1, 0, 1.053e-07, 0, 0.471398, 0)
target_position = Vector3(0, 0, 12)
hit_from_inside = true
collide_with_areas = true

[node name="BackScanner10" type="RayCast3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/RaycastHolder"]
transform = Transform3D(-0.707107, 0, -0.707107, 0, 1, 0, 0.707107, 0, -0.707107, 0, 0.471398, 0)
target_position = Vector3(0, 0, 6)
hit_from_inside = true
collide_with_areas = true

[node name="BackScanner11" type="RayCast3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/RaycastHolder"]
transform = Transform3D(-0.5, 0, -0.866026, 0, 1, 0, 0.866026, 0, -0.5, 0, 0.471398, 0)
target_position = Vector3(0, 0, 6)
hit_from_inside = true
collide_with_areas = true

[node name="BackScanner12" type="RayCast3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/RaycastHolder"]
transform = Transform3D(0.5, -3.72529e-09, -0.866026, 0, 1, -7.45058e-09, 0.866026, -9.76996e-14, 0.5, 1.19209e-07, 0.471398, -4.65661e-10)
target_position = Vector3(0, 0, 6)
hit_from_inside = true
collide_with_areas = true

[node name="BackScanner13" type="RayCast3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/RaycastHolder"]
transform = Transform3D(0.258819, 0, -0.965926, -9.31323e-10, 1, 0, 0.965926, -4.04121e-14, 0.258819, 0, 0.471398, -2.32831e-10)
target_position = Vector3(0, 0, 8)
hit_from_inside = true
collide_with_areas = true

[node name="BackScanner14" type="RayCast3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/RaycastHolder"]
transform = Transform3D(-0.258819, 0, -0.965926, 0, 1, 0, 0.965926, -4.04121e-14, -0.258819, 1.19209e-07, 0.471398, 0)
target_position = Vector3(0, 0, 8)
hit_from_inside = true
collide_with_areas = true

[node name="SpotLight3D" type="OmniLight3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment" index="2"]
transform = Transform3D(-1.25121, -1.42382e-06, 0.460712, -0.460396, -0.0493991, -1.25035, 0.0170704, -1.33242, 0.0463559, 0.00823132, 0.530883, -0.0275215)
light_color = Color(0.258824, 0.65098, 0, 1)
light_energy = 5.872
light_indirect_energy = 2.799
shadow_enabled = true
omni_range = 8.47556

[node name="KillBOX" type="Area3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment" index="3"]
transform = Transform3D(1, 1.03917e-13, -4.37115e-08, -4.37115e-08, 0, -1, -1.08802e-14, 1, 3.72529e-09, 0.000473008, -0.185109, -0.0100487)
collision_layer = 0
monitoring = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/KillBOX"]
transform = Transform3D(1, 1.00586e-13, 1.35003e-13, 2.67009e-12, 1, 1.2666e-07, 8.52651e-14, 3.72529e-09, 1, -0.0155943, 0.135171, 0.00517917)
shape = SubResource("BoxShape3D_8f00h")

[node name="AnimationPlayer" parent="JerryFixed/JerryFixed" index="1"]
blend_times = [&"walkLookRight", &"walkLookRight", 0.5, &"walkLookRight", &"TurnLeftWalk", 0.3, &"walkLookRight", &"TurnRightWalk", 0.2, &"walkLookRight", &"walk", 0.2, &"walkLookRight", &"lunge", 0.1, &"walkLookRight", &"walkLookLeft", 0.3, &"TurnLeftWalk", &"walkLookRight", 0.2, &"TurnLeftWalk", &"TurnLeftWalk", 0.5, &"TurnLeftWalk", &"lookAround1", 0.2, &"TurnLeftWalk", &"TurnRightWalk", 0.3, &"TurnLeftWalk", &"lookAround2", 0.2, &"TurnLeftWalk", &"walk", 0.2, &"TurnLeftWalk", &"lunge", 0.2, &"TurnLeftWalk", &"walkLookLeft", 0.2, &"TurnRightWalk", &"walkLookRight", 0.2, &"TurnRightWalk", &"TurnLeftWalk", 0.3, &"TurnRightWalk", &"lookAround1", 0.2, &"TurnRightWalk", &"TurnRightWalk", 0.5, &"TurnRightWalk", &"lookAround2", 0.2, &"TurnRightWalk", &"walk", 0.2, &"TurnRightWalk", &"lunge", 0.2, &"TurnRightWalk", &"walkLookLeft", 0.2, &"walk", &"walkLookRight", 0.2, &"walk", &"lookAround1", 0.1, &"walk", &"TurnRightWalk", 0.2, &"walk", &"lookAround2", 0.1, &"walk", &"walk", 0.5, &"walk", &"lunge", 0.1, &"walk", &"exitGlitch", 0.2, &"walk", &"walkLookLeft", 0.2, &"lunge", &"walkLookRight", 0.2, &"lunge", &"TurnLeftWalk", 0.3, &"lunge", &"TurnRightWalk", 0.3, &"lunge", &"walk", 0.2, &"lunge", &"lunge", 0.1, &"lunge", &"walkLookLeft", 0.2, &"walkLookLeft", &"walkLookRight", 0.3, &"walkLookLeft", &"TurnLeftWalk", 0.2, &"walkLookLeft", &"TurnRightWalk", 0.3, &"walkLookLeft", &"walk", 0.2, &"walkLookLeft", &"lunge", 0.1, &"walkLookLeft", &"walkLookLeft", 0.5]

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.887602, 0.873154)
visible = false
shape = SubResource("BoxShape3D_ibafn")

[node name="State Machine" type="Node" parent="." node_paths=PackedStringArray("initial_state", "enemy")]
script = ExtResource("2_smmno")
initial_state = NodePath("Idle")
enemy = NodePath("..")

[node name="Idle" type="Node" parent="State Machine" node_paths=PackedStringArray("enemy")]
script = ExtResource("3_5vln3")
move_speed = 2
enemy = NodePath("../..")

[node name="Chase" type="Node" parent="State Machine" node_paths=PackedStringArray("enemy")]
script = ExtResource("4_1g41x")
move_speed = 4
enemy = NodePath("../..")

[node name="Scan" type="Node" parent="State Machine" node_paths=PackedStringArray("enemy")]
script = ExtResource("6_8q1jc")
enemy = NodePath("../..")

[node name="Dash" type="Node" parent="State Machine" node_paths=PackedStringArray("enemy")]
script = ExtResource("5_qtln4")
move_speed = 900
enemy = NodePath("../..")

[node name="Confuse" type="Node" parent="State Machine" node_paths=PackedStringArray("enemy")]
script = ExtResource("6_al6yw")
enemy = NodePath("../..")

[node name="GlitchOut" type="Node" parent="State Machine" node_paths=PackedStringArray("enemy")]
script = ExtResource("9_en0ku")
enemy = NodePath("../..")

[node name="ChaseTimer" type="Timer" parent="."]
wait_time = 3.0
one_shot = true

[node name="ChaseToDashTimer" type="Timer" parent="."]

[node name="DashTimer" type="Timer" parent="."]
wait_time = 3.0

[node name="AliveTimer" type="Timer" parent="."]
wait_time = 10.0
one_shot = true

[connection signal="StartDash" from="JerryFixed" to="State Machine/Dash" method="_on_jerry_fixed_start_dash"]
[connection signal="body_entered" from="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/KillBOX" to="." method="_on_kill_box_body_entered"]
[connection signal="body_exited" from="JerryFixed/JerryFixed/metarig/Skeleton3D/HeadAttachment/KillBOX" to="." method="_on_kill_box_body_exited"]
[connection signal="animation_finished" from="JerryFixed/JerryFixed/AnimationPlayer" to="State Machine/Scan" method="_on_animation_player_animation_finished"]
[connection signal="animation_finished" from="JerryFixed/JerryFixed/AnimationPlayer" to="State Machine/GlitchOut" method="_on_animation_player_animation_finished"]
[connection signal="timeout" from="ChaseTimer" to="State Machine/Chase" method="_on_timer_timeout"]
[connection signal="timeout" from="ChaseToDashTimer" to="State Machine/Chase" method="_on_chase_to_dash_timer_timeout"]
[connection signal="timeout" from="DashTimer" to="State Machine/Dash" method="_on_dash_timer_timeout"]
[connection signal="timeout" from="AliveTimer" to="State Machine/Dash" method="_on_alive_timer_timeout"]

[editable path="JerryFixed"]
